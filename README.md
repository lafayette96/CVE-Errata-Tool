# CVE-Errata-Tool

This set of tools help Red Hat TAMs gather information about CVEs, Erratas, etc.  
It calls https://access.redhat.com/hydra/rest/securitydata API and prints results in the terminal.

## unresolved_cves.py
Provides information about CVEs fulfilling search criteria.
Those include CVE number, release date, severity, URL, description, mitigation strategy, 
affected products and released errata (aka advisory, RHSA).
The script prints data to terminal and saves it to *.csv file.

**Arguments:**  
-h, --help  show help  
-a, --after show only CVEs release after this date  
-b, --before show only CVEs released before this date  
-p, --product show affected products (supports Perl compatible regular expressions)  
-s, --severity choose severity  
-r, --remove-unaffected (yes/no) do not show the packages that are not affected by the CVE

## rhsa.py
Querries Red Hat Security Data API for provided errata (aka advisory, RHSA) and gather information about CVE which it concerns.
Next, it queries the API for CVEs info and prints all other erratas connected to that CVE.


**Arguments:**
-r, --rhsa 

## Examples:

    $ python3 api_call_args.py -a 2022-09-01 -b 2022-09-06 -p "(openstack|jboss)" -s important
    
    
    CVE Number:     | Severity: | Public date: | URL: 

    CVE-2022-3101   | important | 2022-09-02   | https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-3101.json
    CVE-2022-3146   | important | 2022-09-02   | https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-3146.json

<br />

    $ python3 affected_product.py -a 2022-09-01 -b 2022-09-06 -p "(openstack|jboss)" -s important -r yes


    CVE Number:     | Severity: | Public date: | URL: 
    CVE-2022-3101   | important | 2022-09-02   | https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-3101.json

    Affected product:                                               | Fix state:    
    Red Hat OpenStack Platform 16.1                                 | Affected            
    Red Hat OpenStack Platform 16.2                                 | Affected            
    ---------------------------------------------------------------------

    CVE Number:     | Severity: | Public date: | URL: 
    CVE-2022-3146   | important | 2022-09-02   | https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-3146.json

    Affected product:                                               | Fix state:  
    Red Hat OpenShift Container Platform 4                          | Under investigation 
    Red Hat OpenStack Platform 13 (Queens)                          | Under investigation 
    Red Hat OpenStack Platform 16.1                                 | Under investigation 
    Red Hat OpenStack Platform 16.2                                 | Under investigation 
    ---------------------------------------------------------------------
<br />

    $ python3 unresolved_cves.py -a 2022-07-13 -b 2022-07-15 -p "(Fuse 7|Camel K|Quarkus|3scale)" -s important -r yes


    CVE Number: 	| Severity: | Public date: | URL: 
    CVE-2022-31107  | important | 2022-07-14   | https://access.redhat.com/hydra/rest/securitydata/cve/CVE-2022-31107.json

    Description: 
    *) Grafana is an open-source platform for monitoring and observability. In versions 5.3 until 9.0.3, 8.5.9, 8.4.10, and 8.3.10, it is possible for a malicious user who has authorization to log into a Grafana instance via a configured OAuth IdP which provides a login name to take over the account of another user in that Grafana instance. This can occur when the malicious user is authorized to log in to Grafana via OAuth, the malicious user's external user id is not already associated with an account in Grafana, the malicious user's email address is not already associated with an account in Grafana, and the malicious user knows the Grafana username of the target user. If these conditions are met, the malicious user can set their username in the OAuth provider to that of the target user, then go through the OAuth flow to log in to Grafana. Due to the way that external and internal user accounts are linked together during login, if the conditions above are all met then the malicious user will be able to log in to the target user's Grafana account. Versions 9.0.3, 8.5.9, 8.4.10, and 8.3.10 contain a patch for this issue. As a workaround, concerned users can disable OAuth login to their Grafana instance, or ensure that all users authorized to log in via OAuth have a corresponding user account in Grafana linked to their email address.
    *) A flaw was found in Grafana. This flaw allows a malicious user with the authorization to log into a Grafana instance via a configured OAuth IdP to take over an existing Grafana account under certain conditions.

    Mitigation strategy: 
    As a workaround, it is possible to disable any OAuth login or ensure that all users authorized to log in via OAuth have a corresponding user account in Grafana linked to their email address.

    Affected product: 						| Fix state:  
        None of your products is affected by this CVE. Have a good day! :)

    Released errata for product: 					| Release date: | Advisory name:
    Red Hat Enterprise Linux 8                                      | 2022-07-26    | RHSA-2022:5717      
    Red Hat Enterprise Linux 8.1 Update Services for SAP Solutions  | 2022-07-26    | RHSA-2022:5720      
    Red Hat Enterprise Linux 8.2 Extended Update Support            | 2022-07-26    | RHSA-2022:5719      
    Red Hat Enterprise Linux 8.4 Extended Update Support            | 2022-07-26    | RHSA-2022:5718      
    Red Hat Enterprise Linux 9                                      | 2022-07-26    | RHSA-2022:5716      


    ----------------------------------------------------------------------------------------------------------------------------------------------
<br />

    $ python3 rhsa.py -r RHSA-2022:0188

    CVE-2022-0185: 

    Released errata for product: 					| Release date: | Advisory name:
    Red Hat Enterprise Linux 8                                      | 2022-01-19    | RHSA-2022:0176      
    Red Hat Enterprise Linux 8                                      | 2022-01-19    | RHSA-2022:0188      
    Red Hat Enterprise Linux 8                                      | 2022-01-24    | RHSA-2022:0232      
    Red Hat Enterprise Linux 8.4 Extended Update Support            | 2022-01-19    | RHSA-2022:0187      
    Red Hat Enterprise Linux 8.4 Extended Update Support            | 2022-01-19    | RHSA-2022:0186      
    Red Hat Enterprise Linux 8.4 Extended Update Support            | 2022-01-24    | RHSA-2022:0231      
    Red Hat Virtualization 4 for Red Hat Enterprise Linux 8         | 2022-02-15    | RHSA-2022:0540      


    -------------------------------------------------------------------------------------------------


    CVE-2021-4155: 

    Released errata for product: 					| Release date: | Advisory name:
    Red Hat Enterprise Linux 6 Extended Lifecycle Support           | 2022-04-19    | RHSA-2022:1417      
    Red Hat Enterprise Linux 7                                      | 2022-02-22    | RHSA-2022:0622      
    Red Hat Enterprise Linux 7                                      | 2022-02-22    | RHSA-2022:0592      
    Red Hat Enterprise Linux 7                                      | 2022-02-22    | RHSA-2022:0620      
    Red Hat Enterprise Linux 7.3 Advanced Update Support            | 2022-02-15    | RHSA-2022:0529      
    Red Hat Enterprise Linux 7.4 Advanced Update Support            | 2022-02-15    | RHSA-2022:0530      
    Red Hat Enterprise Linux 7.6 Advanced Update Support            | 2022-02-15    | RHSA-2022:0531      
    Red Hat Enterprise Linux 7.6 Telco Extended Update Support      | 2022-02-15    | RHSA-2022:0531      
    Red Hat Enterprise Linux 7.6 Update Services for SAP Solutions  | 2022-02-15    | RHSA-2022:0531      
    Red Hat Enterprise Linux 7.6 Update Services for SAP Solutions  | 2022-02-15    | RHSA-2022:0533      
    Red Hat Enterprise Linux 7.7 Advanced Update Support            | 2022-03-01    | RHSA-2022:0712      
    Red Hat Enterprise Linux 7.7 Telco Extended Update Support      | 2022-03-01    | RHSA-2022:0712      
    Red Hat Enterprise Linux 7.7 Update Services for SAP Solutions  | 2022-03-01    | RHSA-2022:0712      
    Red Hat Enterprise Linux 7.7 Update Services for SAP Solutions  | 2022-03-01    | RHSA-2022:0718      
    Red Hat Enterprise Linux 8                                      | 2022-01-19    | RHSA-2022:0176      
    Red Hat Enterprise Linux 8                                      | 2022-01-19    | RHSA-2022:0188      
    Red Hat Enterprise Linux 8                                      | 2022-01-24    | RHSA-2022:0232      
    Red Hat Enterprise Linux 8.1 Update Services for SAP Solutions  | 2022-02-01    | RHSA-2022:0335      
    Red Hat Enterprise Linux 8.1 Update Services for SAP Solutions  | 2022-02-01    | RHSA-2022:0344      
    Red Hat Enterprise Linux 8.1 Update Services for SAP Solutions  | 2022-03-17    | RHSA-2022:0958      
    Red Hat Enterprise Linux 8.2 Extended Update Support            | 2022-02-22    | RHSA-2022:0629      
    Red Hat Enterprise Linux 8.2 Extended Update Support            | 2022-02-22    | RHSA-2022:0590      
    Red Hat Enterprise Linux 8.2 Extended Update Support            | 2022-02-22    | RHSA-2022:0636      
    Red Hat Enterprise Linux 8.4 Extended Update Support            | 2022-01-19    | RHSA-2022:0187      
    Red Hat Enterprise Linux 8.4 Extended Update Support            | 2022-01-19    | RHSA-2022:0186      
    Red Hat Enterprise Linux 8.4 Extended Update Support            | 2022-01-24    | RHSA-2022:0231      
    Red Hat Virtualization 4 for Red Hat Enterprise Linux 7         | 2022-04-07    | RHSA-2022:1263      
    Red Hat Virtualization 4 for Red Hat Enterprise Linux 8         | 2022-02-15    | RHSA-2022:0540      


    -------------------------------------------------------------------------------------------------
